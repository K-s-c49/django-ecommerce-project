{% extends "app/base.html" %}
{% load static %}
{% block title %}Order{% endblock title %}

{% block main-content %}
<div class="container py-4">    

  <!-- Header -->
  <div class="row align-items-center mb-4">
    <div class="col-md-8 d-flex align-items-center">
      <h3 class="fw-bold text-dark mb-0">
        Welcome, <span class="text-primary text-capitalize">{{ request.user }}</span>
      </h3>
    </div>
    <div class="col-md-4 text-md-end">
      <a class="btn btn-outline-primary d-inline-flex align-items-center shadow-sm" href="{% url 'orders' %}">
        <i class="bi bi-bag-check-fill me-2"></i> View All Orders
      </a>
    </div>
  </div>

  <!-- Orders Loop -->
  {% for op in order_Placed %}
  <div class="card shadow-sm border-0 mb-4 rounded-3 overflow-hidden">
    <div class="row g-0 align-items-center">

      <!-- Product Image -->
      <div class="col-4 col-md-3 p-3 d-flex justify-content-center">
        <div class="product-thumb shadow-sm" style="background-image: url('{{ op.product.product_image.url }}');"></div>
      </div>

      <!-- Product Info -->
      <div class="col-8 col-md-3 p-3 border-start">
        <p class="mb-1"><i class="bi bi-box-seam me-1 text-secondary"></i> <strong>{{ op.product.title }}</strong></p>
        <p class="mb-1"><i class="bi bi-stack me-1 text-secondary"></i> Qty: {{ op.quantity }}</p>
        <p class="mb-0 text-success fw-bold"><i class="bi bi-currency-rupee me-1"></i>{{ op.total_cost }}</p>
      </div>

      <!-- Order Status -->
      <div class="col-12 col-md-6 p-3 border-top border-md-start">
        <p class="mb-2 fw-semibold text-muted">
          <i class="bi bi-truck me-1"></i> Status: {{ op.status }}
        </p>

        <!-- Progress with color per status -->
        {% if op.status == "pending" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-secondary" style="width: 8%"></div>
          </div>
        {% endif %}

        {% if op.status == "accepted" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-primary" style="width: 20%"></div>
          </div>
        {% endif %}

        {% if op.status == "packed" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-info" style="width: 40%"></div>
          </div>
        {% endif %}

        {% if op.status == "on_the_way" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-warning" style="width: 70%"></div>
          </div>
        {% endif %}

        {% if op.status == "delivered" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-success" style="width: 100%"></div>
          </div>
          <p class="small text-success mt-2"><i class="bi bi-check-circle-fill me-1"></i> Delivered Successfully</p>
        {% endif %}

        {% if op.status == "cancel" %}
          <div class="progress" style="height: 8px;">
            <div class="progress-bar bg-danger" style="width: 100%"></div>
          </div>
          <p class="small text-danger mt-2"><i class="bi bi-x-circle-fill me-1"></i> Order Cancelled</p>
        {% endif %}
      </div>
    </div>
  </div>
  {% empty %}
  <div class="text-center py-5">
    <img src="{% static 'app/image/product/logo.png' %}" alt="No Orders" class="img-fluid mb-3" style="max-height: 150px;">
    <p class="text-muted">You have no orders yet. Start shopping!</p>
    <a href="/" class="btn btn-primary"><i class="bi bi-cart-plus me-1"></i> Shop Now</a>
  </div>
  {% endfor %}
  <!-- Orders End -->

</div>

<!-- CSS -->
<style>
  .product-thumb {
    width: 90px;
    height: 90px;
    background-size: cover;
    background-position: center;
    border-radius: 10px;
  }
</style>

{% endblock main-content %}